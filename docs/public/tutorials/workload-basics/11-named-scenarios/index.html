<!doctype html><html lang=en><head><script integrity=sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1 src=https://docs.nosqlbench.io/js/theme.min.js></script><link href="https://docs.nosqlbench.io/abridge.css?h=17d1d14ae374495df55a" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://docs.nosqlbench.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link href=https://docs.nosqlbench.io/favicon.svg rel=icon type=image/svg+xml><link title="NoSQLBench Documentation Atom Feed" href=https://docs.nosqlbench.io/atom.xml rel=alternate type=application/atom+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>Named Scenarios | NoSQLBench Documentation</title><meta content="NoSQLBench Team" name=author><meta content="NoSQLBench Documentation" name=copyright><meta content="Creating reusable scenario workflows in workload templates" name=description><link href=https://docs.nosqlbench.io/tutorials/workload-basics/11-named-scenarios/ rel=canonical><meta content=https://docs.nosqlbench.io/tutorials/workload-basics/11-named-scenarios/ property=og:url><meta content=https://docs.nosqlbench.io/tutorials/workload-basics/11-named-scenarios/ name=twitter:url><meta content="Creating reusable scenario workflows in workload templates" property=og:description><meta content="Creating reusable scenario workflows in workload templates" name=twitter:description><meta content="Named Scenarios | NoSQLBench Documentation" property=og:title><meta content="Named Scenarios | NoSQLBench Documentation" name=twitter:title><meta content=summary name=twitter:card><meta content="NoSQLBench Documentation" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta property=og:updated_time><script src="https://docs.nosqlbench.io/js/theme_button.js?h=12a31e87fcbe7a55e953" defer integrity=sha384-UBxLGgFVZtEgNzOU3WqKoFT1oILftGjShFO4WIs1dO/jK7SNyz7BMYCYt5PffTxe></script><script src="https://docs.nosqlbench.io/js/email.js?h=ee3dd742e11c5014fdef" defer integrity=sha384-y0LUfjslyVLYZvCOyhELpvKivlXAq27Vnbed54glXoe/pZSYS/Pfqghp/sQt1xcV></script><script src="https://docs.nosqlbench.io/js/codecopy.js?h=0a54f99e682443925d3a" defer integrity=sha384-qssVvPpQgISh4PFkSBGTgXEMzuFO8Hat5m1MsdkpannoByWSTpLfBe4iEVl3+RiP></script><script src="https://docs.nosqlbench.io/js/elasticlunr.min.js?h=4f648b9e42abdef9c436" defer integrity=sha384-Q8viz7rndi8MSNDtItDgVWNSrCumjepopRMlz2nElkWPRXDQAcfiZGJbrCJVXdtw></script><script src="https://docs.nosqlbench.io/search_index.en.js?h=e2df0fd710d0c807a7aa" defer integrity=sha384-nyOftseEtxo2Pc23RFR1hxsCZHtUr0xOCP7JVJ8oGIs+cnDq6GZkzCq2hWZ2cJIh></script><script src="https://docs.nosqlbench.io/js/searchjava.js?h=36b818b07e8b2b318967" defer integrity=sha384-i6K7Uy98ZLnOwn6no8sDUTeBitDmiLHOKxkcJYbjgu6vQ3hdyMQPzmeuX04BRs8J></script><noscript><link href=https://docs.nosqlbench.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="NoSQLBench Documentation" href=https://docs.nosqlbench.io></a></big></div><div><div><ul><li><a href=https://docs.nosqlbench.io/tutorials/> Tutorials </a><li><a href=https://docs.nosqlbench.io/guides/> Guides </a><li><a href=https://docs.nosqlbench.io/reference/> Reference </a><li><a href=https://docs.nosqlbench.io/explanations/> Explanations </a><li><a href=https://docs.nosqlbench.io/development/> Development </a><li><a href=https://github.com/nosqlbench/nosqlbench target=_blank> GitHub </a><li><i class="js svgs adjust" id=mode type=reset></i></ul></div><div><div><form autocomplete=off class=js id=searchbox name=goSearch><div class=searchd><input id=searchinput placeholder=Search title=Search><button class="svgs svgm search" title=Search></button></div><div class=results><div id=suggestions></div></div></form></div></div></div></nav></header><main><article><h1><a href=https://docs.nosqlbench.io/tutorials/workload-basics/11-named-scenarios/>Named Scenarios</a></h1><p>There is one final element of a yaml that you need to know about: <em>named scenarios</em>.<p><strong>Named Scenarios allow anybody to run your testing workflows with a single command.</strong><p>You can provide named scenarios for a workload like this:<pre class=language-yaml data-lang=yaml style=color:#c0c5ce;background-color:#2b303b><code class=language-yaml data-lang=yaml><span style=color:#65737e># contents of myworkloads.yaml
</span><span style=color:#bf616a>scenarios</span><span>:
</span><span>  </span><span style=color:#bf616a>default</span><span>:
</span><span>    - </span><span style=color:#a3be8c>run driver=diag cycles=10 alias=first-ten
</span><span>    - </span><span style=color:#a3be8c>run driver=diag cycles=10..20 alias=second-ten
</span><span>  </span><span style=color:#bf616a>longrun</span><span>:
</span><span>    - </span><span style=color:#a3be8c>run driver=diag cycles=10M
</span></code></pre><p>This provides a way to specify more detailed workflows that users may want to run without them having to build up a command line for themselves.<p>A couple of other forms are supported in the YAML, for terseness:<pre class=language-yaml data-lang=yaml style=color:#c0c5ce;background-color:#2b303b><code class=language-yaml data-lang=yaml><span style=color:#bf616a>scenarios</span><span>:
</span><span>  </span><span style=color:#bf616a>oneliner</span><span>: </span><span style=color:#a3be8c>run driver=diag cycles=10
</span><span>  </span><span style=color:#bf616a>mapform</span><span>:
</span><span>    </span><span style=color:#bf616a>part1</span><span>: </span><span style=color:#a3be8c>run driver=diag cycles=10 alias=part2
</span><span>    </span><span style=color:#bf616a>part2</span><span>: </span><span style=color:#a3be8c>run driver=diag cycles=20 alias=part2
</span></code></pre><p>These forms simply provide finesse for common editing habits, but they are automatically read internally as a list of named steps. In the map form, the names are used to name activities. The order is retained.<h2 id=scenario-selection>Scenario selection</h2><p>When a named scenario is run, it is <em>always</em> named, so that it can be looked up in the list of named scenarios under your <code>scenarios:</code> property. The only exception to this is when an explicit scenario name is not found on the command line, in which case it is automatically assumed to be <code>default</code>.<p>Some examples may be more illustrative:<pre style=color:#c0c5ce;background-color:#2b303b><code><span># runs the scenario named 'default' if it exists, or throws an error if it does not.
</span><span>nb5 myworkloads
</span><span># or
</span><span>nb5 myworkloads default
</span><span>
</span><span># runs the named scenario 'longrun' if it exists, or throws an error if it does not.
</span><span>nb5 myworkloads longrun
</span><span>
</span><span># runs the named scenario 'longrun' if it exists, or throws an error if it does not.
</span><span># this is simply the canonical form which is more verbose, but more explicit.
</span><span>nb5 scenario myworkloads longrun
</span><span>
</span><span># run multiple named scenarios from one workload, and then some from another
</span><span>nb5 scenario myworkloads longrun default longrun scenario another.yaml name1 name2
</span><span># In this form ^ you may have to add the explicit form to avoid conflicts between
</span><span># workload names and scenario names. That's why the explicit form is provided, after all.
</span></code></pre><h2 id=workload-selection>Workload selection</h2><p>The examples above contain no reference to a workload (formerly called <em>yaml</em>). They donâ€™t need to, as they refer to themselves implicitly. You may add a <code>workload=</code> parameter to the command templates if you like, but this is never needed for basic use, and it is error-prone to keep the filename matched to the command template. Just leave it out by default.<p><em>However</em>, if you are doing advanced scripting across multiple systems, you can actually provide a <code>workload=</code> parameter particularly to use another workload description in your test.<p>ðŸ‘‰ This is a powerful feature for workload automation and organization. However, it can get unwieldy quickly. Caution is advised for deep-linking too many scenarios in a workspace, as there is no mechanism for keeping them in sync when small changes are made.<h2 id=named-scenario-discovery>Named Scenario Discovery</h2><p>For named scenarios, there is a way for users to find all the named scenarios that are currently bundled or in view of their current directory. A couple simple rules must be followed by scenario publishers in order to keep things simple:<ol><li>Workload files in the current directory <code>*.yaml</code> are considered.<li>Workload files under in the relative path <code>activities/</code> with name <code>*.yaml</code> are considered.<li>The same rules are used when looking in the bundled NoSQLBench, so built-ins come along for the ride.<li>Any workload file that contains a <code>scenarios:</code> tag is included, but all others are ignored.</ol><p>This doesnâ€™t mean that you canâ€™t use named scenarios for workloads in other locations. It simply means that when users use the <code>--list-scenarios</code> option, these are the only ones they will see listed.<h2 id=parameter-overrides>Parameter Overrides</h2><p>You can override parameters that are provided by named scenarios. Any parameter that you specify on the command line after your workload and optional scenario name will be used to override or augment the commands that are provided for the named scenario.<p>This is powerful, but it also means that you can sometimes munge user-provided activity parameters on the command line with the named scenario commands in ways that may not make sense. To solve this, the parameters in the named scenario commands may be locked. You can lock them silently, or you can provide a verbose locking that will cause an error if the user even tries to adjust them.<p>Silent locking is provided with a form like <code>param==value</code>. Any silent locked parameters will reject overrides from the command line, but will not interrupt the user.<p>Verbose locking is provided with a form like <code>param===value</code>. Any time a user provides a parameter on the command line for the named parameter, an error is thrown, and they are informed that this is not possible. This level is provided for cases in which you would not want the user to be unaware of an unset parameter which is germain and specific to the named scenario.<p>All other parameters provided by the user will take the place of the same-named parameters provided in <em>each</em> command templates, in the order they appear in the template. Any other parameters provided by the user will be added to <em>each</em> of the command templates in the order they appear on the command line.<p>This is a little counter-intuitive at first, but once you see some examples it should make sense.<h2 id=parameter-override-examples>Parameter Override Examples</h2><p>Consider a simple workload with three named scenarios:<pre class=language-yaml data-lang=yaml style=color:#c0c5ce;background-color:#2b303b><code class=language-yaml data-lang=yaml><span style=color:#65737e># basics.yaml
</span><span style=color:#bf616a>scenarios</span><span>:
</span><span>  </span><span style=color:#bf616a>s1</span><span>: </span><span style=color:#a3be8c>run driver=stdout cycles=10
</span><span>  </span><span style=color:#bf616a>s2</span><span>: </span><span style=color:#a3be8c>run driver=stdout cycles==10
</span><span>  </span><span style=color:#bf616a>s3</span><span>: </span><span style=color:#a3be8c>run driver=stdout cycles===10
</span><span>
</span><span style=color:#bf616a>bindings</span><span>:
</span><span>  </span><span style=color:#bf616a>c</span><span>: </span><span style=color:#a3be8c>Identity()
</span><span>
</span><span style=color:#bf616a>statements</span><span>:
</span><span>  - </span><span style=color:#bf616a>A</span><span>: "</span><span style=color:#a3be8c>cycle={c}</span><span style=color:#96b5b4>\n</span><span>"
</span></code></pre><p>Running this with no options prompts the user to select one of the named scenarios:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>$ nb5 basics
</span><span>ERROR: Unable to find named scenario 'default' in workload 'basics', but you can pick from s1,s2,s3
</span><span>$
</span></code></pre><h3 id=basic-override-example>Basic Override example</h3><p>If you run the first scenario <code>s1</code> with your own value for <code>cycles=7</code>, it does as you ask:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>$ nb5 basics s1 cycles=7
</span><span>Logging to logs/scenario_20200324_205121_554.log
</span><span>cycle=0
</span><span>cycle=1
</span><span>cycle=2
</span><span>cycle=3
</span><span>cycle=4
</span><span>cycle=5
</span><span>cycle=6
</span><span>$
</span></code></pre><h3 id=silent-locking-example>Silent Locking example</h3><p>If you run the second scenario <code>s2</code> with your own value for <code>cycles=7</code>, then it does what the locked parameter <code>cycles==10</code> requires, without telling you that it is ignoring the specified value on your command line.<pre style=color:#c0c5ce;background-color:#2b303b><code><span>$ nb5 basics s2 cycles=7
</span><span>Logging to logs/scenario_20200324_205339_486.log
</span><span>cycle=0
</span><span>cycle=1
</span><span>cycle=2
</span><span>cycle=3
</span><span>cycle=4
</span><span>cycle=5
</span><span>cycle=6
</span><span>cycle=7
</span><span>cycle=8
</span><span>cycle=9
</span><span>$
</span></code></pre><p>Sometimes, this is appropriate, such as when specifying settings like <code>threads==</code> for schema activities.<h3 id=verbose-locking-example>Verbose Locking example</h3><p>If you run the third scenario <code>s3</code> with your own value for <code>cycles=7</code>, then you will get an error telling you that this is not possible. Sometimes you want to make sure tha the user knows a parameter should not be changed, and that if they want to change it, theyâ€™ll have to make their own custom version of the scenario in question.<pre style=color:#c0c5ce;background-color:#2b303b><code><span>$ nb5 basics s3 cycles=7
</span><span>ERROR: Unable to reassign value for locked param 'cycles===7'
</span><span>$
</span></code></pre><p>Ultimately, it is up to the scenario designer when to lock parameters for users. The built-in workloads offer some examples on how to set these parameters so that the right value are locked in place without bother the user, but some values are made very clear in how they should be set. Please look at these examples for inspiration when you need.<h2 id=forcing-undefined-parameters>Forcing Undefined Parameters</h2><p>If you want to ensure that any parameter in a named scenario template remains unset in the generated scenario script, you can assign it a value of <code>UNDEF</code>. The locking behaviors described above apply to this one as well. Thus, for schema commands which rely on the default sequence length (which is based on the number of active statements), you can set <code>cycles==UNDEF</code> to ensure that when a user passes a cycles parameter, the schema activity doesnâ€™t break with too many cycles.<h2 id=automatic-parameters>Automatic Parameters</h2><p>Some parameters are already known due to the fact that you are using named scenarios.<p><em>workload</em><p>The <code>workload</code> parameter is, by default, set to the logical path (fully qualified workload name) of the yaml file containing the named scenario. However, if the command template contains this parameter, it may be overridden by users as any other parameter depending on the assignment operators as explained above.<p><em>alias</em><p>The <code>alias</code> parameter is, by default, set to the expanded name of WORKLOAD_SCENARIO_STEP, which means that each activity within the scenario has a distinct and symbolic name. This is important for distinguishing metrics from one another across workloads, named scenarios, and steps within a named scenario. The above words are interpolated into the alias as follows:<ul><li><p>WORKLOAD - The simple name part of the fully qualified workload name. For example, with a workload (yaml path) of foo/bar/baz.yaml, the WORKLOAD name used here would be <code>baz</code>.</p><li><p>SCENARIO - The name of the scenario as provided on the command line.</p><li><p>STEP - The name of the step in the named scenario. If you used the list or string forms to provide a command template, then the steps are automatically named as a zero-padded number representing the step in the named scenario, starting from <code>000</code>, per named scenario. (The numbers are not globally assigned)</p></ul><p>Because it is important to have uniquely named activities for the sake of sane metrics and logging, any alias provided when using named scenarios which does not include the three tokens above will cause a warning to be issued to the user explaining why this is a bad idea.<p>ðŸ‘‰ UNDEF is handled before alias expansion above, so it is possible to force the default activity naming behavior above with <code>alias===UNDEF</code>. This is generally recommended, and will inform users if they try to set the alias in an unsafe way.</article></main><footer><div class=c><nav class=tpad><div></div></nav><p>Â© <span id=year>2025</span> NoSQLBench Documentation<p>Powered by <a href=https://www.getzola.org/ target=_blank>Zola</a> & <a href=https://github.com/jieiku/abridge/ target=_blank>Abridge</a></div></footer><span class=topout> <span class=topleft> </span><a title="Back to Top" class=top href=#><i class="svgs svgh angu"></i></a> </span>