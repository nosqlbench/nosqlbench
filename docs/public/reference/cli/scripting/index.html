<!doctype html><html lang=en><head><script integrity=sha384-pb++s6uBRKaQv+iAXpgA/H3IlpLZdO14tTwuCI7uXmz4aaZdByoCcM+6BhynMq/1 src=https://docs.nosqlbench.io/js/theme.min.js></script><link href="https://docs.nosqlbench.io/abridge.css?h=17d1d14ae374495df55a" rel=stylesheet><meta charset=utf-8><meta content="ie=edge" http-equiv=x-ua-compatible><meta content="width=device-width,initial-scale=1" name=viewport><meta content=https://docs.nosqlbench.io name=base><meta content=True name=HandheldFriendly><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=default name=apple-mobile-web-app-status-bar-style><link href=https://docs.nosqlbench.io/favicon.svg rel=icon type=image/svg+xml><link title="NoSQLBench Documentation Atom Feed" href=https://docs.nosqlbench.io/atom.xml rel=alternate type=application/atom+xml><meta content="index, follow" name=robots><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=googlebot><meta content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" name=bingbot><title>CLI Scripting | NoSQLBench Documentation</title><meta content="NoSQLBench Team" name=author><meta content="NoSQLBench Documentation" name=copyright><meta content="Command line scenario scripting reference" name=description><link href=https://docs.nosqlbench.io/reference/cli/scripting/ rel=canonical><meta content=https://docs.nosqlbench.io/reference/cli/scripting/ property=og:url><meta content=https://docs.nosqlbench.io/reference/cli/scripting/ name=twitter:url><meta content="Command line scenario scripting reference" property=og:description><meta content="Command line scenario scripting reference" name=twitter:description><meta content="CLI Scripting | NoSQLBench Documentation" property=og:title><meta content="CLI Scripting | NoSQLBench Documentation" name=twitter:title><meta content=summary name=twitter:card><meta content="NoSQLBench Documentation" property=og:site_name><meta content=en_US property=og:locale><meta content=website property=og:type><meta property=og:updated_time><script src="https://docs.nosqlbench.io/js/theme_button.js?h=12a31e87fcbe7a55e953" defer integrity=sha384-UBxLGgFVZtEgNzOU3WqKoFT1oILftGjShFO4WIs1dO/jK7SNyz7BMYCYt5PffTxe></script><script src="https://docs.nosqlbench.io/js/email.js?h=ee3dd742e11c5014fdef" defer integrity=sha384-y0LUfjslyVLYZvCOyhELpvKivlXAq27Vnbed54glXoe/pZSYS/Pfqghp/sQt1xcV></script><script src="https://docs.nosqlbench.io/js/codecopy.js?h=0a54f99e682443925d3a" defer integrity=sha384-qssVvPpQgISh4PFkSBGTgXEMzuFO8Hat5m1MsdkpannoByWSTpLfBe4iEVl3+RiP></script><script src="https://docs.nosqlbench.io/js/elasticlunr.min.js?h=4f648b9e42abdef9c436" defer integrity=sha384-Q8viz7rndi8MSNDtItDgVWNSrCumjepopRMlz2nElkWPRXDQAcfiZGJbrCJVXdtw></script><script src="https://docs.nosqlbench.io/search_index.en.js?h=e2df0fd710d0c807a7aa" defer integrity=sha384-nyOftseEtxo2Pc23RFR1hxsCZHtUr0xOCP7JVJ8oGIs+cnDq6GZkzCq2hWZ2cJIh></script><script src="https://docs.nosqlbench.io/js/searchjava.js?h=36b818b07e8b2b318967" defer integrity=sha384-i6K7Uy98ZLnOwn6no8sDUTeBitDmiLHOKxkcJYbjgu6vQ3hdyMQPzmeuX04BRs8J></script><noscript><link href=https://docs.nosqlbench.io/nojs.css rel=stylesheet></noscript><body><header><nav><div><big><a title="NoSQLBench Documentation" href=https://docs.nosqlbench.io></a></big></div><div><div><ul><li><a href=https://docs.nosqlbench.io/tutorials/> Tutorials </a><li><a href=https://docs.nosqlbench.io/guides/> Guides </a><li><a href=https://docs.nosqlbench.io/reference/> Reference </a><li><a href=https://docs.nosqlbench.io/explanations/> Explanations </a><li><a href=https://docs.nosqlbench.io/development/> Development </a><li><a href=https://github.com/nosqlbench/nosqlbench target=_blank> GitHub </a><li><i class="js svgs adjust" id=mode type=reset></i></ul></div><div><div><form autocomplete=off class=js id=searchbox name=goSearch><div class=searchd><input id=searchinput placeholder=Search title=Search><button class="svgs svgm search" title=Search></button></div><div class=results><div id=suggestions></div></div></form></div></div></div></nav></header><main><article><h1><a href=https://docs.nosqlbench.io/reference/cli/scripting/>CLI Scripting</a></h1><p>Sometimes you want to run a set of workloads in a particular order, or call other specific test setup logic in between activities or workloads. While the full scripting environment allows you to do this and more, it is not necessary to write JavaScript for every scenario.<p>For more basic setup and sequencing needs, you can achieve a fair degree of flexibility on the command line. A few key API calls are supported directly on the command line. This guide explains each of them, what the do, and how to use them together.<h2 id=script-construction>Script Construction</h2><p>As the command line is parsed, from left to right, the scenario script is built in an internal scripting buffer. Once the command line is fully parsed, this script is executed. Each of the commands below is effectively a macro for a script fragment. It is important to remember that order is important.<h2 id=command-line-format>Command line format</h2><p>Newlines are not allowed when building scripts from the command line. As long as you follow the allowed forms below, you can simply string multiple commands together with spaces between. Single word options without leading dashes, like <code>run</code>, are scenario commands. Subsequent <code>key=value</code> style arguments are their named parameters. Named parameters which follow a scenario command apply to that command only.<p>Global options, meaning any argument that starts with a <code>-</code> or <code>--</code>, are applied when NoSQLBench starts up, before any scenario is run. These are automatically taken out of the list of what the scenario scripting sees.<h2 id=concurrency-control>Concurrency & Control</h2><p>All activities operate parallel to the scenario script, allowing them to run independently at their own pace, while the scenario controls and manages them like an automaton. The scenario concludes only when both the scenario script and the activities are finished.<h2 id=scenario-commands>Scenario Commands</h2><h3 id=start>start</h3><p>example: <code>start driver=&LTdriver> alias=&LTalias> ...</code><p>You can start an activity with this command. At the time this command is evaluated, the activity is started, and the script continues without blocking. This is an asynchronous start of an activity. If you start multiple activities in this way, they will run concurrently.<p>The driver argument is required to identify which nb5 driver to run. The alias parameter is not strictly required, unless you want to be able to interact with the started activity later. In any case, it is a good idea to name all your activities with a meaningful alias.<h3 id=await>await</h3><p>example: <code>await &LTalias></code><p>Await the normal completion of an activity with the given alias. This causes the scenario script to pause while it waits for the named activity to finish. This does not tell the activity to stop. It simply puts the scenario script into a paused state until the named activity is complete.<h3 id=run>run</h3><p>example: <code>run driver=&LTdriver> alias=&LTalias> ...</code><p>Run an activity to completion, waiting until it is complete before continuing with the scenario script. It is effectively the same as<pre style=color:#c0c5ce;background-color:#2b303b><code><span>start driver=&LTactivity type> ... alias=&LTalias>
</span><span>await &LTalias>
</span></code></pre><h3 id=stop>stop</h3><p>example: <code>stop &LTalias></code><p>Stop an activity with the given alias. This is synchronous, and causes the scenario to pause until the activity is stopped. This means that all threads for the activity have completed and signalled that they’re in a stopped state. This command allows an activity to stop gracefully if possible. It waits for a number of seconds for all threads to come to a stopped state and will then resort to using forceStop if needed. Threads which are occupied blocking on remote timeouts or blocking behavior can prevent an activity from shutting down gracefully.<h3 id=forcestop>forcestop</h3><p>syntax: <code>forcestop &LTalias></code><p>This is like the stop command, except that it doesn’t allow the activity to shut down gracefully. This command immediately shutdown down the thread pool for a given activity.<h3 id=waitmillis>waitmillis</h3><p>example: <code>waitmillis &LTmilliseconds></code><p>Pause the scenario script for this many milliseconds. This doesn’t affect any running activities directly. This is useful for controlling workload run duration, etc.<h3 id=script>script</h3><p>example: <code>script &LTscript file></code><p>Add the contents of the named file to the scenario script buffer.<h3 id=fragment>fragment</h3><p>example: <code>fragment &LTscript text></code><p>Add the contents of the next argument to the scenario script buffer.<h1 id=an-example-cli-script>An example CLI script</h1><p>Any sequence of these commands, when strung together, constitutes a scenario script. An example of this is: <code>./nb5 start driver=stdout alias=a cycles=100K workload=cql-iot tags=block:main start driver=stdout alias=b cycles=200K workload=cql-iot tags=block:main waitmillis 10000 await a stop b</code><p>This is terribly confusing to look at, so we do something like this instead. The backslashes at the end allow you to insert a discarded newline, <em>as long as there are no spaces after the backslash.</em><pre class=language-shell data-lang=shell data-linenos style=color:#c0c5ce;background-color:#2b303b><code class=language-shell data-lang=shell><table><tbody><tr><td>1<td><span>./nb5 \
</span><tr><td>2<td><span>start driver=stdout alias=a cycles=100K workload=cql-iot tags=block:main \
</span><tr><td>3<td><span>start driver=stdout alias=b cycles=200K workload=cql-iot tags=block:main \
</span><tr><td>4<td><span>waitmillis 10000 \
</span><tr><td>5<td><span>await a \
</span><tr><td>6<td><span>stop b
</span></table></code></pre><p>Here is a narrative of what happens for each line:<pre data-linenos style=color:#c0c5ce;background-color:#2b303b><code><table><tbody><tr><td>1<td><span># nb5 is invoked
</span><tr><td>2<td><span># An activity named 'a' is started, with 100K cycles of work.
</span><tr><td>3<td><span># An activity named 'b' is started, with 200K cycles of work.
</span><tr><td>4<td><span># While these activities run, the scenario script waits for ten seconds.
</span><tr><td>5<td><span># The scenario blocks, waiting for activity 'a' to complete its 100K cycles.
</span><tr><td>6<td><span># Activity 'b' is immediately stopped.
</span></table></code></pre><p>After the stop command at the end of the scenarios script, the whole scenario exits, because all activities are stopped or complete, <strong>and</strong> the script is complete.</article></main><footer><div class=c><nav class=tpad><div></div></nav><p>© <span id=year>2025</span> NoSQLBench Documentation<p>Powered by <a href=https://www.getzola.org/ target=_blank>Zola</a> & <a href=https://github.com/jieiku/abridge/ target=_blank>Abridge</a></div></footer><span class=topout> <span class=topleft> </span><a title="Back to Top" class=top href=#><i class="svgs svgh angu"></i></a> </span>